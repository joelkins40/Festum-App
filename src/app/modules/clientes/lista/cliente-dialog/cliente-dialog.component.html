<!-- 📝 Modal para Crear/Editar Clientes -->
<div class="cliente-dialog">

  <!-- Header del Modal -->
  <div class="dialog-header">
    <div class="header-content">
      <mat-icon class="header-icon">{{ modo === 'crear' ? 'person_add' : 'edit' }}</mat-icon>
      <h2 class="header-title">{{ modo === 'crear' ? 'Nuevo Cliente' : 'Editar Cliente' }}</h2>
    </div>
    <button mat-icon-button (click)="cancelar()" class="close-button" matTooltip="Cerrar">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <!-- Contenido del Modal -->
  <div class="dialog-content">
    <form [formGroup]="clienteForm" class="cliente-form">

      <!-- Campo Nombre -->
      <div class="form-section">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Nombre completo del cliente</mat-label>
          <input matInput formControlName="nombre" placeholder="Ej: María González Rodríguez..." maxlength="100"
            #nombreInput>
          <mat-icon matPrefix class="input-icon">person</mat-icon>

          <!-- Mensajes de Error -->
          <mat-error *ngIf="nombre?.hasError('required')">
            El nombre es requerido
          </mat-error>
          <mat-error *ngIf="nombre?.hasError('minlength')">
            El nombre debe tener al menos 2 caracteres
          </mat-error>
          <mat-error *ngIf="nombre?.hasError('maxlength')">
            El nombre no puede exceder 100 caracteres
          </mat-error>
          <mat-error *ngIf="nombre?.hasError('pattern')">
            Solo se permiten letras y espacios
          </mat-error>

          <!-- Contador de caracteres -->
          <mat-hint align="end">
            {{ nombreInput.value.length || 0 }}/100
          </mat-hint>
        </mat-form-field>
      </div>

      <!-- Campo Dirección -->
      <div class="form-section">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Dirección (opcional)</mat-label>
          <textarea matInput formControlName="direccion"
            placeholder="Dirección completa del cliente (por definir estructura...)" maxlength="200" rows="3"
            #direccionInput></textarea>
          <mat-icon matPrefix class="input-icon">location_on</mat-icon>

          <!-- Mensajes de Error -->
          <mat-error *ngIf="direccion?.hasError('maxlength')">
            La dirección no puede exceder 200 caracteres
          </mat-error>

          <!-- Contador de caracteres -->
          <mat-hint align="end">
            {{ direccionInput.value.length || 0 }}/200
          </mat-hint>
        </mat-form-field>
      </div>

      <!-- Campo Cliente Preferente -->
      <div class="form-section">
        <div class="checkbox-container">
          <mat-checkbox formControlName="clientePreferente" class="cliente-preferente-checkbox">
            <div class="checkbox-content">
              <div class="checkbox-label">
                <mat-icon class="checkbox-icon">star</mat-icon>
                <span class="checkbox-text">Cliente Preferente</span>
              </div>
              <div class="checkbox-description">
                Los clientes preferentes reciben descuentos especiales y atención prioritaria
              </div>
            </div>
          </mat-checkbox>
        </div>
      </div>

      <!-- Información adicional para edición -->
      <div class="info-section" *ngIf="modo === 'editar' && data.cliente">
        <div class="info-card">
          <h4 class="info-title">
            <mat-icon>info</mat-icon>
            Información del Registro
          </h4>
          <div class="info-grid">
            <div class="info-item">
              <span class="info-label">Fecha de creación:</span>
              <span class="info-value">{{ data.cliente?.fechaCreacion | date:'dd/MM/yyyy HH:mm' }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">ID:</span>
              <span class="info-value">#{{ data.cliente?.id }}</span>
            </div>
          </div>
        </div>
      </div>

    </form>
  </div>

  <!-- Footer con botones de acción -->
  <div class="dialog-footer">
    <div class="button-group">
      <button mat-button (click)="cancelar()" class="cancel-button" [disabled]="guardando">
        <mat-icon>cancel</mat-icon>
        Cancelar
      </button>

      <button mat-raised-button color="primary" (click)="guardar()" class="save-button"
        [disabled]="!esFormularioValido || guardando">
        <mat-icon>{{ guardando ? 'hourglass_empty' : (modo === 'crear' ? 'save' : 'update') }}</mat-icon>
        {{ guardando ? 'Guardando...' : (modo === 'crear' ? 'Crear Cliente' : 'Actualizar Cliente') }}
      </button>
    </div>
  </div>

</div>
