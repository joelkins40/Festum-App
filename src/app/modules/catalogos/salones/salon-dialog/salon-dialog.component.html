<!-- 📝 Modal para Crear/Editar Salones -->
<div class="salon-dialog">

  <!-- Header del Modal -->
  <div class="dialog-header">
    <div class="header-content">
      <mat-icon class="header-icon">{{ modo === 'crear' ? 'add_business' : 'edit' }}</mat-icon>
      <h2 class="header-title">{{ modo === 'crear' ? 'Nuevo Salón' : 'Editar Salón' }}</h2>
    </div>
    <button mat-icon-button (click)="onCancel()" class="close-button" matTooltip="Cerrar">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <!-- Contenido del Modal -->
  <div class="dialog-content">
    <form [formGroup]="salonForm" class="salon-form">

      <!-- Nombre del Salón -->
      <div class="form-section">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Nombre del salón</mat-label>
          <input matInput formControlName="nombre" placeholder="Ej: Salón Cristal, Jardín Rosa..." maxlength="100"
            #nombreInput>
          <mat-icon matPrefix class="input-icon">business</mat-icon>

          <!-- Mensajes de Error -->
          <mat-error *ngIf="f['nombre'].hasError('required')">
            El nombre es requerido
          </mat-error>
          <mat-error *ngIf="f['nombre'].hasError('minlength')">
            El nombre debe tener al menos 3 caracteres
          </mat-error>
          <mat-error *ngIf="f['nombre'].hasError('maxlength')">
            El nombre no puede exceder 100 caracteres
          </mat-error>

          <!-- Contador de caracteres -->
          <mat-hint align="end">
            {{ nombreInput.value.length || 0 }}/100
          </mat-hint>
        </mat-form-field>
      </div>

      <!-- Dirección -->
      <div class="form-section">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Dirección completa</mat-label>
          <textarea matInput formControlName="direccion" placeholder="Ej: Av. Reforma 123, Col. Centro, CDMX" rows="2"
            maxlength="200" #direccionInput></textarea>
          <mat-icon matPrefix class="input-icon">location_on</mat-icon>

          <!-- Mensajes de Error -->
          <mat-error *ngIf="f['direccion'].hasError('required')">
            La dirección es requerida
          </mat-error>
          <mat-error *ngIf="f['direccion'].hasError('minlength')">
            La dirección debe tener al menos 10 caracteres
          </mat-error>
          <mat-error *ngIf="f['direccion'].hasError('maxlength')">
            La dirección no puede exceder 200 caracteres
          </mat-error>

          <!-- Contador de caracteres -->
          <mat-hint align="end">
            {{ direccionInput.value.length || 0 }}/200
          </mat-hint>
        </mat-form-field>
      </div>

      <!-- Fila: Capacidad y Tipo de Evento -->
      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Capacidad de personas</mat-label>
          <input matInput type="number" formControlName="capacidadDePersonas" min="1" max="1000" placeholder="150">
          <mat-icon matPrefix class="input-icon">people</mat-icon>

          <mat-error *ngIf="f['capacidadDePersonas'].hasError('required')">
            La capacidad es requerida
          </mat-error>
          <mat-error *ngIf="f['capacidadDePersonas'].hasError('min')">
            La capacidad mínima es 1
          </mat-error>
          <mat-error *ngIf="f['capacidadDePersonas'].hasError('max')">
            La capacidad máxima es 1000
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Tipo de evento</mat-label>
          <mat-select formControlName="tipoEventoId">
            <mat-option *ngFor="let tipo of tiposEvento" [value]="tipo.id">
              {{ tipo.descripcion }}
            </mat-option>
          </mat-select>
          <mat-icon matPrefix class="input-icon">event</mat-icon>

          <mat-error *ngIf="f['tipoEventoId'].hasError('required')">
            El tipo de evento es requerido
          </mat-error>
        </mat-form-field>
      </div>

      <!-- Fila: Precio y Teléfono -->
      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Precio de renta</mat-label>
          <input matInput type="number" formControlName="precioRenta" min="0" step="0.01" placeholder="15000.00">
          <mat-icon matPrefix class="input-icon">attach_money</mat-icon>

          <mat-error *ngIf="f['precioRenta'].hasError('required')">
            El precio es requerido
          </mat-error>
          <mat-error *ngIf="f['precioRenta'].hasError('min')">
            El precio no puede ser negativo
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Teléfono de contacto (opcional)</mat-label>
          <input matInput formControlName="telefonoContacto" placeholder="55-1234-5678">
          <mat-icon matPrefix class="input-icon">phone</mat-icon>

          <mat-error *ngIf="f['telefonoContacto'].hasError('pattern')">
            Formato de teléfono inválido
          </mat-error>

          <mat-hint>
            Incluya código de área
          </mat-hint>
        </mat-form-field>
      </div>

      <!-- Información adicional para edición -->
      <div *ngIf="modo === 'editar'" class="info-section">
        <div class="info-item">
          <mat-icon class="info-icon">event</mat-icon>
          <span class="info-label">Fecha de creación:</span>
          <span class="info-value">{{ data.salon?.fechaCreacion | date:'dd/MM/yyyy HH:mm' }}</span>
        </div>
        <div class="info-item">
          <mat-icon class="info-icon">tag</mat-icon>
          <span class="info-label">ID:</span>
          <span class="info-value">#{{ data.salon?.id }}</span>
        </div>
      </div>

    </form>
  </div>

  <!-- Acciones del Modal -->
  <div class="dialog-actions">
    <button mat-stroked-button (click)="onCancel()" class="cancel-button">
      <mat-icon>cancel</mat-icon>
      Cancelar
    </button>

    <button mat-raised-button color="primary" (click)="onSave()" [disabled]="!salonForm.valid || guardando"
      class="save-button">
      <mat-icon>{{ guardando ? 'hourglass_empty' : (modo === 'crear' ? 'save' : 'update') }}</mat-icon>
      {{ guardando ? 'Guardando...' : (modo === 'crear' ? 'Crear Salón' : 'Actualizar Salón') }}
    </button>
  </div>

</div>
